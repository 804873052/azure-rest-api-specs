# yaml-language-server: $schema=https://raw.githubusercontent.com/Azure/azure-rest-api-specs/main/documentation/api-scenario/references/v1.2/schema.json
scope: ResourceGroup

variables:
  labName:
    type: string
    prefix: labna
  adminPassword:
    type: string
  scheduleName:
    type: string
    prefix: schedulena


prepareSteps:
      - operationId: Labs_CreateOrUpdate
        # exampleFile: ..\examples\Labs\putLab.json
        parameters:
          body:
            location: $(location)
            properties: 
              title: Test Lab
              description: This is a test lab.
              connectionProfile: 
                webSshAccess: None
                webRdpAccess: None
                clientSshAccess: Public
                clientRdpAccess: Public
              autoShutdownProfile:
                shutdownOnDisconnect: Enabled
                shutdownWhenNotConnected: Enabled
                shutdownOnIdle: UserAbsence
                disconnectDelay: PT15M
                noConnectDelay: PT15M
                idleDelay: PT15M
              securityProfile: 
                openAccess: Disabled
              virtualMachineProfile:
                createOption: TemplateVM
                sku: 
                  name: Standard_Fsv2_2_4GB_64_S_SSD
                  capacity: 0
                additionalCapabilities: 
                  installGpuDrivers: Disabled
                usageQuota: 2
                useSharedPassword: Disabled
                adminUser:
                  username: test-user
                  password: $(adminPassword)
                imageReference:
                  offer: 0001-com-ubuntu-server-focal
                  publisher: canonical
                  sku: 20_04-lts
                  version: latest

# pass
scenarios:
  - scenario: Schedules
    description: Microsoft.LabServices/labs/{labName}/schedules/{scheduleName}
    steps:
      - operationId: Schedules_CreateOrUpdate
        exampleFile: ..\examples\Schedules\putSchedule.json
      - operationId: Schedules_ListByLab
        exampleFile: ..\examples\Schedules\listSchedule.json
      - operationId: Schedules_Get
        exampleFile: ..\examples\Schedules\getSchedule.json
      - operationId: Schedules_Update
        exampleFile: ..\examples\Schedules\patchSchedule.json
      - operationId: Schedules_Delete
        exampleFile: ..\examples\Schedules\deleteSchedule.json
