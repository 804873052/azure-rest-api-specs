scope: ResourceGroup
testScenarios:
  - description: test_network_virtual_appliance
    steps:
      - step: RawStep_2480
        method: GET
        rawUrl: >-
          https://management.azure.com/subscriptions/00000000-0000-0000-0000-000000000000/resourcegroups/clitest.rg000001?api-version=2020-10-01
        requestHeaders:
          Accept: application/json
          Accept-Encoding: gzip, deflate
          CommandName: network vwan create
          Connection: keep-alive
          ParameterSetName: '-n -g --type'
          User-Agent: >-
            python/3.7.3 (Windows-10-10.0.19041-SP0) msrest/0.6.21
            msrest_azure/0.6.3 azure-mgmt-resource/12.0.0 Azure-SDK-For-Python
            AZURECLI/2.20.0
          accept-language: en-US
        responseExpected: >-
          {"id":"/subscriptions/00000000-0000-0000-0000-000000000000/resourceGroups/clitest.rg000001","name":"clitest.rg000001","type":"Microsoft.Resources/resourceGroups","location":"westcentralus","tags":{"product":"azurecli","cause":"automation","date":"2021-03-04T07:14:35Z"},"properties":{"provisioningState":"Succeeded"}}
      - step: RawStep_2481
        method: PUT
        rawUrl: >-
          https://management.azure.com/subscriptions/00000000-0000-0000-0000-000000000000/resourceGroups/clitest.rg000001/providers/Microsoft.Network/virtualWans/clitestvwan?api-version=2020-05-01
        requestBody: '{"location":"westcentralus"}'
        requestHeaders:
          Accept: application/json
          Accept-Encoding: gzip, deflate
          CommandName: network vwan create
          Connection: keep-alive
          Content-Length: '29'
          Content-Type: application/json; charset=utf-8
          ParameterSetName: '-n -g --type'
          User-Agent: >-
            python/3.7.3 (Windows-10-10.0.19041-SP0) msrest/0.6.21
            msrest_azure/0.6.3 azure-mgmt-network/10.2.0 Azure-SDK-For-Python
            AZURECLI/2.20.0
          accept-language: en-US
        statusCode: 201
        responseExpected: >-
          {"name":"clitestvwan","id":"/subscriptions/00000000-0000-0000-0000-000000000000/resourceGroups/clitest.rg000001/providers/Microsoft.Network/virtualWans/clitestvwan","etag":"W/\"8264e4d0-56a7-41b3-b1e6-50e5b6519618\"","type":"Microsoft.Network/virtualWans","location":"westcentralus","properties":{"provisioningState":"Updating","disableVpnEncryption":false,"allowBranchToBranchTraffic":true,"office365LocalBreakoutCategory":"None","type":"Standard"}}
      - step: RawStep_2482
        method: GET
        rawUrl: >-
          https://management.azure.com/subscriptions/00000000-0000-0000-0000-000000000000/resourcegroups/clitest.rg000001?api-version=2020-10-01
        requestHeaders:
          Accept: application/json
          Accept-Encoding: gzip, deflate
          CommandName: network vhub create
          Connection: keep-alive
          ParameterSetName: '-g -n --vwan --address-prefix --sku'
          User-Agent: >-
            python/3.7.3 (Windows-10-10.0.19041-SP0) msrest/0.6.21
            msrest_azure/0.6.3 azure-mgmt-resource/12.0.0 Azure-SDK-For-Python
            AZURECLI/2.20.0
          accept-language: en-US
        responseExpected: >-
          {"id":"/subscriptions/00000000-0000-0000-0000-000000000000/resourceGroups/clitest.rg000001","name":"clitest.rg000001","type":"Microsoft.Resources/resourceGroups","location":"westcentralus","tags":{"product":"azurecli","cause":"automation","date":"2021-03-04T07:14:35Z"},"properties":{"provisioningState":"Succeeded"}}
      - step: RawStep_2483
        method: PUT
        rawUrl: >-
          https://management.azure.com/subscriptions/00000000-0000-0000-0000-000000000000/resourceGroups/clitest.rg000001/providers/Microsoft.Network/virtualHubs/clitestvhub?api-version=2020-05-01
        requestBody: >-
          {"location":"westcentralus","properties":{"virtualWan":{"id":"/subscriptions/00000000-0000-0000-0000-000000000000/resourceGroups/clitest.rg000001/providers/Microsoft.Network/virtualWans/clitestvwan"},"addressPrefix":"10.5.0.0/16","sku":"Standard"}}
        requestHeaders:
          Accept: application/json
          Accept-Encoding: gzip, deflate
          CommandName: network vhub create
          Connection: keep-alive
          Content-Length: '316'
          Content-Type: application/json; charset=utf-8
          ParameterSetName: '-g -n --vwan --address-prefix --sku'
          User-Agent: >-
            python/3.7.3 (Windows-10-10.0.19041-SP0) msrest/0.6.21
            msrest_azure/0.6.3 azure-mgmt-network/10.2.0 Azure-SDK-For-Python
            AZURECLI/2.20.0
          accept-language: en-US
        statusCode: 201
        responseExpected: >-
          {"name":"clitestvhub","id":"/subscriptions/00000000-0000-0000-0000-000000000000/resourceGroups/clitest.rg000001/providers/Microsoft.Network/virtualHubs/clitestvhub","etag":"W/\"5b6d16a3-c19c-4b4d-8f7f-0c088f77f5c3\"","type":"Microsoft.Network/virtualHubs","location":"westcentralus","properties":{"provisioningState":"Updating","virtualHubRouteTableV2s":[],"addressPrefix":"10.5.0.0/16","virtualRouterAsn":0,"virtualRouterIps":[],"routeTable":{"routes":[]},"virtualWan":{"id":"/subscriptions/00000000-0000-0000-0000-000000000000/resourceGroups/clitest.rg000001/providers/Microsoft.Network/virtualWans/clitestvwan"},"sku":"Standard","routingState":"None"}}
      - step: RawStep_2484
        method: GET
        rawUrl: >-
          https://management.azure.com/subscriptions/00000000-0000-0000-0000-000000000000/resourcegroups/clitest.rg000001?api-version=2020-10-01
        requestHeaders:
          Accept: application/json
          Accept-Encoding: gzip, deflate
          CommandName: network virtual-appliance create
          Connection: keep-alive
          ParameterSetName: >-
            -n -g --vhub --vendor --scale-unit -v --asn --init-config
            --boot-blobs --cloud-blobs
          User-Agent: >-
            python/3.7.3 (Windows-10-10.0.19041-SP0) msrest/0.6.21
            msrest_azure/0.6.3 azure-mgmt-resource/12.0.0 Azure-SDK-For-Python
            AZURECLI/2.20.0
          accept-language: en-US
        responseExpected: >-
          {"id":"/subscriptions/00000000-0000-0000-0000-000000000000/resourceGroups/clitest.rg000001","name":"clitest.rg000001","type":"Microsoft.Resources/resourceGroups","location":"westcentralus","tags":{"product":"azurecli","cause":"automation","date":"2021-03-04T07:14:35Z"},"properties":{"provisioningState":"Succeeded"}}
      - step: Create_networkVirtualAppliances_cli-virtual-appliance
        resourceName: networkVirtualAppliances_cli-virtual-appliance
        exampleFile: >-
          ../examples/Create_networkVirtualAppliances_cli-virtual-appliance_Generated.json
        operationId: NetworkVirtualAppliances_CreateOrUpdate
      - step: Update_networkVirtualAppliances_cli-virtual-appliance_2487
        resourceName: networkVirtualAppliances_cli-virtual-appliance
        operationId: NetworkVirtualAppliances_CreateOrUpdate
        resourceUpdate:
          - replace: /properties/virtualApplianceAsn
            value: 20000
          - replace: /properties/cloudInitConfiguration
            value: echo $abcd
      - step: NetworkVirtualAppliances_ListByResourceGroup_2488
        exampleFile: >-
          ../examples/NetworkVirtualAppliances_ListByResourceGroup_2488_Generated.json
        operationId: NetworkVirtualAppliances_ListByResourceGroup
      - step: NetworkVirtualAppliances_List_2489
        exampleFile: ../examples/NetworkVirtualAppliances_List_2489_Generated.json
        operationId: NetworkVirtualAppliances_List
      - step: VirtualApplianceSkus_List_2490
        exampleFile: ../examples/VirtualApplianceSkus_List_2490_Generated.json
        operationId: VirtualApplianceSkus_List
      - step: VirtualApplianceSkus_Get_2491
        exampleFile: ../examples/VirtualApplianceSkus_Get_2491_Generated.json
        operationId: VirtualApplianceSkus_Get
      - step: Create_virtualApplianceSites_cli-site
        resourceName: virtualApplianceSites_cli-site
        exampleFile: ../examples/Create_virtualApplianceSites_cli-site_Generated.json
        operationId: VirtualApplianceSites_CreateOrUpdate
      - step: Update_virtualApplianceSites_cli-site_2494
        resourceName: virtualApplianceSites_cli-site
        operationId: VirtualApplianceSites_CreateOrUpdate
        resourceUpdate:
          - replace: /properties/addressPrefix
            value: 10.0.0.1/24
          - replace: /properties/o365Policy/breakOutCategories/optimize
            value: false
          - replace: /properties/o365Policy/breakOutCategories/allow
            value: false
          - replace: /properties/o365Policy/breakOutCategories/default
            value: false
      - step: VirtualApplianceSites_List_2495
        exampleFile: ../examples/VirtualApplianceSites_List_2495_Generated.json
        operationId: VirtualApplianceSites_List
      - step: VirtualApplianceSites_Delete_2496
        exampleFile: ../examples/VirtualApplianceSites_Delete_2496_Generated.json
        operationId: VirtualApplianceSites_Delete
      - step: NetworkVirtualAppliances_Delete_2497
        exampleFile: ../examples/NetworkVirtualAppliances_Delete_2497_Generated.json
        operationId: NetworkVirtualAppliances_Delete
    variables:
      networkVirtualApplianceName: cli-virtual-appliance
      skuName: barracudasdwanrelease
      siteName: cli-site
