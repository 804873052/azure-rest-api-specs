# yaml-language-server: $schema=https://raw.githubusercontent.com/Azure/azure-rest-api-specs/main/documentation/api-scenario/references/v1.2/schema.json
scope: ResourceGroup
variables:
  location:
    type: string
  elasticSanName:
    type: string
    prefix: elastics
  volumeGroupName:
    type: string
    prefix: volumegr
  volumeName:
    type: string
    prefix: volumena
  # privateEndpointConnectionName:
  #   type: string
  #   prefix: privatee
  snapshotName:
    type: string
    prefix: snapshot

prepareSteps:
      - operationId: ElasticSans_Create
        exampleFile: ..\examples\ElasticSans_Create_MaximumSet_Gen.json
        outputVariables:
          elasticsanId:
            type: string
            fromResponse: /id
      - operationId: VolumeGroups_Create
        exampleFile: ..\examples\VolumeGroups_Create_MinimumSet_Gen.json
      - operationId: Volumes_Create
        exampleFile: ..\examples\Volumes_Create_MaximumSet_Gen.json
        # outputVariables:
        #   volumeId:
        #     type: string
        #     fromResponse: /id

scenarios:
# pass
  - scenario: ElasticSans
    description: Microsoft.ElasticSan/elasticSans/{elasticSanName}
    steps:
      - operationId: ElasticSans_ListBySubscription
        exampleFile: ..\examples\ElasticSans_ListBySubscription_MaximumSet_Gen.json
      - operationId: ElasticSans_ListByResourceGroup
        exampleFile: ..\examples\ElasticSans_ListByResourceGroup_MaximumSet_Gen.json
      - operationId: ElasticSans_Get
        exampleFile: ..\examples\ElasticSans_Get_MaximumSet_Gen.json
      - operationId: ElasticSans_Update
        exampleFile: ..\examples\ElasticSans_Update_MaximumSet_Gen.json

# pass
  - scenario: VolumeGroups
    description: Microsoft.ElasticSan/elasticSans/{elasticSanName}/volumegroups/{volumeGroupName}
    steps:
      - operationId: VolumeGroups_ListByElasticSan
        exampleFile: ..\examples\VolumeGroups_ListByElasticSan_MaximumSet_Gen.json
      - operationId: VolumeGroups_Get
        exampleFile: ..\examples\VolumeGroups_Get_MaximumSet_Gen.json
      - operationId: VolumeGroups_Update
        exampleFile: ..\examples\VolumeGroups_Update_MinimumSet_Gen.json

# pass
  - scenario: Volumes
    description: Microsoft.ElasticSan/elasticSans/{elasticSanName}/volumegroups/{volumeGroupName}/volumes/{volumeName}
    steps:
      - operationId: Volumes_ListByVolumeGroup
        exampleFile: ..\examples\Volumes_ListByVolumeGroup_MaximumSet_Gen.json
      - operationId: Volumes_Get
        exampleFile: ..\examples\Volumes_Get_MaximumSet_Gen.json
      - operationId: Volumes_Update
        exampleFile: ..\examples\Volumes_Update_MaximumSet_Gen.json

# pass
  - scenario: VolumeSnapshots
    description: Microsoft.ElasticSan/elasticSans/{elasticSanName}/volumegroups/{volumeGroupName}/snapshots/{snapshotName}
    steps:
      - operationId: VolumeSnapshots_Create
        exampleFile: ..\examples\VolumeSnapshots_Create_MaximumSet_Gen.json
        requestUpdate:
          - replace: /parameters/properties/creationData/sourceId
            value: $(volumeId)
      - operationId: VolumeSnapshots_ListByVolumeGroup
        exampleFile: ..\examples\VolumeSnapshots_ListByVolumeGroup_MaximumSet_Gen.json
      - operationId: VolumeSnapshots_Get
        exampleFile: ..\examples\VolumeSnapshots_Get_MaximumSet_Gen.json
      - operationId: VolumeSnapshots_Delete
        exampleFile: ..\examples\VolumeSnapshots_Delete_MaximumSet_Gen.json

# fail 
# Values for request parameters are invalid: groupId
  # - scenario: PrivateEndpointConnections
  #   description: Microsoft.ElasticSan/elasticSans/{elasticSanName}/privateEndpointConnections/{privateEndpointConnectionName}
  #   steps:
  #     - step: Create_PrivateEndpoint
  #       armTemplate: ./templates/Create_PrivateEndpoint.json
  #     - operationId: PrivateEndpointConnections_List
  #       exampleFile: ..\examples\PrivateEndpointConnections_List_MaximumSet_Gen.json
  #       outputVariables:
  #         privateEndpointConnectionName:
  #           type: string
  #           fromResponse: /value/0/name
  #     - operationId: PrivateEndpointConnections_Create
  #       exampleFile: ..\examples\PrivateEndpointConnections_Create_MaximumSet_Gen.json
  #     - operationId: PrivateEndpointConnections_Get
  #       exampleFile: ..\examples\PrivateEndpointConnections_Get_MaximumSet_Gen.json
  #     - operationId: PrivateLinkResources_ListByElasticSan
  #       exampleFile: ..\examples\PrivateLinkResources_ListByElasticSan_MaximumSet_Gen.json
  #     - operationId: PrivateEndpointConnections_Delete
  #       exampleFile: ..\examples\PrivateEndpointConnections_Delete_MaximumSet_Gen.json
        

# pass
  - scenario: Operations
    description: Microsoft.ElasticSan/operations
    steps:
      - operationId: Operations_List
        exampleFile: ..\examples\Operations_List_MaximumSet_Gen.json

# pass
  - scenario: Skus
    description: Microsoft.ElasticSan/skus
    steps:
      - operationId: Skus_List
        exampleFile: ..\examples\Skus_List_MaximumSet_Gen.json


cleanUpSteps:
      - operationId: Volumes_Delete
        exampleFile: ..\examples\Volumes_Delete_MaximumSet_Gen.json
      - operationId: VolumeGroups_Delete
        exampleFile: ..\examples\VolumeGroups_Delete_MaximumSet_Gen.json
      - operationId: ElasticSans_Delete
        exampleFile: ..\examples\ElasticSans_Delete_MaximumSet_Gen.json
