# yaml-language-server: $schema=https://raw.githubusercontent.com/Azure/azure-rest-api-specs/main/documentation/api-scenario/references/v1.2/schema.json
scope: ResourceGroup

scenarios:
  - scenario: DatabaseAccounts 
    description: Microsoft.DocumentDB/databaseAccounts/{accountName}
    variables:
      accountName:
        type: string
        prefix: accountn
    steps:
      - step: DatabaseAccounts_CheckNameExists
        exampleFile: ..\examples\CosmosDBDatabaseAccountCheckNameExists.json
        requestUpdate:
          - replace: /accountName
            value: $(accountName)
      - step: DatabaseAccounts_CreateOrUpdate
        exampleFile: ..\examples\CosmosDBDatabaseAccountCreateMin.json
        requestUpdate:
          - replace: /createUpdateParameters/properties/locations
            value: [
              {
                "failoverPriority": "2",
                "locationName": "southcentralus",
                "is_zone_redundant": False
              },
              {
                "locationName": "eastus",
                "failoverPriority": "1"
              },
              {
                "locationName": "westus",
                "failoverPriority": "0"
              }
            ]
      - step: DatabaseAccounts_List
        exampleFile: ..\examples\CosmosDBDatabaseAccountList.json
      - step: DatabaseAccounts_ListUsages
        exampleFile: ..\examples\CosmosDBDatabaseAccountGetUsages.json
        requestUpdate:
          - replace: /$filter
            value: ""
      - step: DatabaseAccounts_GetReadOnlyKeys
        # exampleFile: ..\examples\CosmosDBDatabaseAccountListReadOnlyKeys.json
        operationId: DatabaseAccounts_GetReadOnlyKeys
      - step: DatabaseAccounts_ListByResourceGroup
        exampleFile: ..\examples\CosmosDBDatabaseAccountListByResourceGroup.json
      - step: DatabaseAccounts_ListMetricDefinitions
        exampleFile: ..\examples\CosmosDBDatabaseAccountGetMetricDefinitions.json
      # - step: DatabaseAccounts_ListMetrics  # filter
      #   exampleFile: ..\examples\CosmosDBDatabaseAccountGetMetrics.json
      - step: DatabaseAccounts_Get
        exampleFile: ..\examples\CosmosDBDatabaseAccountGet.json
      - step: DatabaseAccounts_Update
        # exampleFile: ..\examples\CosmosDBDatabaseAccountPatch.json
        operationId: DatabaseAccounts_Update
        parameters:
          updateParameters:
            tags:
              dept: finance
      - step: DatabaseAccounts_RegenerateKey
        exampleFile: ..\examples\CosmosDBDatabaseAccountRegenerateKey.json
      - step: DatabaseAccounts_ListReadOnlyKeys
        # exampleFile: ..\examples\CosmosDBDatabaseAccountListReadOnlyKeys.json
        operationId: DatabaseAccounts_ListReadOnlyKeys

      # - step: DatabaseAccounts_OfflineRegion # offlineRegion capability not enabled for database account account
      #   exampleFile: ..\examples\CosmosDBDatabaseAccountOfflineRegion.json
      # - step: DatabaseAccounts_OnlineRegion
      #   exampleFile: ..\examples\CosmosDBDatabaseAccountOnlineRegion.json

      - step: DatabaseAccounts_ListConnectionStrings
        exampleFile: ..\examples\CosmosDBDatabaseAccountListConnectionStrings.json
      - step: DatabaseAccounts_ListKeys
        exampleFile: ..\examples\CosmosDBDatabaseAccountListKeys.json
      - step: DatabaseAccounts_FailoverPriorityChange
        exampleFile: ..\examples\CosmosDBDatabaseAccountFailoverPriorityChange.json
        requestUpdate:
          - add: /failoverParameters/failoverPolicies/2
            value: {
                "failoverPriority": "2",
                "locationName": "southcentralus"
            }

      - step: RestorableDatabaseAccounts_ListByLocation
        exampleFile: ..\examples\CosmosDBRestorableDatabaseAccountList.json
      # - step: RestorableDatabaseAccounts_GetByLocation
      #   exampleFile: ..\examples\CosmosDBRestorableDatabaseAccountGet.json
      - step: RestorableDatabaseAccounts_List
        exampleFile: ..\examples\CosmosDBRestorableDatabaseAccountNoLocationList.json


      - step: DatabaseAccounts_Delete
        exampleFile: ..\examples\CosmosDBDatabaseAccountDelete.json
        