# yaml-language-server: $schema=https://raw.githubusercontent.com/Azure/azure-rest-api-specs/main/documentation/api-scenario/references/v1.2/schema.json
scope: ResourceGroup

# variables:
#   azureTenantId:
#     type: string

scenarios:
  - scenario: DiskEncryptionSet
    description: Microsoft.Compute/diskEncryptionSets CRUD
    variables:
      vaultName:
        type: string
      diskEncryptionSetName: scenario_des
    steps:
      - step: KeyVault_CreateVault
        armTemplate: ./peArmTemplate/Create_Vault.json
      - step: KeyVault_CreateKey
        armTemplate: ./peArmTemplate/Create_Key.json
      - step: DiskEncryptionSet_Create
        exampleFile: ../examples/CreateADiskEncryptionSet.json
        requestUpdate:
          - replace: /diskEncryptionSet/properties/activeKey/sourceVault/id
            value: $(vaultID)
          - replace: /diskEncryptionSet/properties/activeKey/keyUrl
            value: $(keyUri)
      - step: DiskEncryptionSet_Get
        exampleFile: ../examples/GetInformationAboutADiskEncryptionSetWithAutoKeyRotationError.json
      - step: DiskEncryptionSet_Update
        exampleFile: ../examples/UpdateADiskEncryptionSetWithRotationToLatestKeyVersionEnabled.json
      - step: DiskEncryptionSet_List
        exampleFile: ../examples/ListDiskEncryptionSetsInASubscription.json
      - step: DiskEncryptionSet_ListByResourceGroup
        exampleFile: ../examples/ListDiskEncryptionSetsInAResourceGroup.json
      - step: DiskEncryptionSet_ListAssociatedResources
        exampleFile: ../examples/ListDiskEncryptionSetAssociatedResources.json
      - step: DiskEncryptionSet_Delete
        exampleFile: ../examples/DeleteADiskEncryptionSet.json





