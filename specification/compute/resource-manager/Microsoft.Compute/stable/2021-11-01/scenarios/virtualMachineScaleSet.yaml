# yaml-language-server: $schema=https://raw.githubusercontent.com/Azure/azure-rest-api-specs/main/documentation/api-scenario/references/v1.2/schema.json
scope: ResourceGroup

scenarios:
  - scenario: VirtualMachineScaleSets
    description: Microsoft.Compute/virtualMachineScaleSets CRUD
    variables:
      vmScaleSetName: scenario_vmss
    steps:
      - step: NetworkAndSubnet_Create
        armTemplate: peArmTemplate/Create_Network_And_Subnet.json
      - step: VirtualMachineScaleSets_Create
        exampleFile: ../examples/compute/CreateAScaleSetWithScaleInPolicy.json
        requestUpdate:
          - replace: /parameters/properties/virtualMachineProfile/networkProfile/networkInterfaceConfigurations/0/properties/ipConfigurations/0/properties/subnet/id
            value: $(subnetID)
          - replace: /parameters/sku/capactiy
            value: 1
          # osProfile
          - replace: /parameters/properties/virtualMachineProfile/osProfile/computerNamePrefix
            value: test
          - replace: /parameters/properties/virtualMachineProfile/osProfile/adminUsername
            value: goscenacrio
          - add: /parameters/properties/virtualMachineProfile/osProfile/adminPassword
            value: QWEqwe123*
      - step: VirtualMachineScaleSets_Update
        exampleFile: ../examples/compute/VirtualMachineScaleSets_Update_MinimumSet_Gen.json
      - step: VirtualMachineScaleSets_Get
        exampleFile: ../examples/compute/GetVirtualMachineScaleSet.json
      - step: VirtualMachineScaleSets_List
        exampleFile: ../examples/compute/VirtualMachineScaleSets_List_MaximumSet_Gen.json
      - step: VirtualMachineScaleSets_ListAll
        exampleFile: ../examples/compute/VirtualMachineScaleSets_ListAll_MaximumSet_Gen.json
      - step: VirtualMachineScaleSets_Delete
        exampleFile: ../examples/compute/ForceDeleteVirtualMachineScaleSets.json


