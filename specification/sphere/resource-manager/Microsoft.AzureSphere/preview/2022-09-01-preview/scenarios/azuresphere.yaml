# yaml-language-server: $schema=https://raw.githubusercontent.com/Azure/azure-rest-api-specs/main/documentation/api-scenario/references/v1.2/schema.json
scope: ResourceGroup

variables:
  catalogName:
    type: string
    prefix: catalogn
  productName:
    type: string
    prefix: productn
  deviceGroupName:
    type: string
    prefix: devicegr
  deviceName:
    type: string
    prefix: devicena
  # serialNumber:
  #   type: string
  #   prefix: serialnu
  imageName:
    type: string
    prefix: imagenam
  deploymentName:
    type: string
    prefix: deployme

prepareSteps:
  - operationId: Catalogs_CreateOrUpdate
    # exampleFile: ..\examples\PutCatalog.json
    parameters:
        resource:
          location: global

scenarios:

# pass
  - scenario: Catalogs
    description: Microsoft.AzureSphere/catalogs/{catalogName}
    steps:
      - operationId: Catalogs_ListBySubscription
        exampleFile: ..\examples\GetCatalogsSub.json
      - operationId: Catalogs_ListByResourceGroup
        exampleFile: ..\examples\GetCatalogsRG.json
      - operationId: Catalogs_Get
        exampleFile: ..\examples\GetCatalog.json
      - operationId: Catalogs_ListDeployments
        exampleFile: ..\examples\PostListDeploymentsByCatalog.json
      # - operationId: Catalogs_Update # ResourcePatchValidateFailed
      #   exampleFile: ..\examples\PatchCatalog.json
      # - operationId: Catalogs_CountDevices # ResourcePostActionFailed
      #   exampleFile: ..\examples\PostCountDevicesCatalog.json
      # - operationId: Catalogs_ListDeviceGroups # ResourcePostActionFailed
      #   exampleFile: ..\examples\PostListDeviceGroupsCatalog.json
      # - operationId: Catalogs_ListDeviceInsights # ResourcePostActionFailed
      #   exampleFile: ..\examples\PostListDeviceInsightsCatalog.json
      # - operationId: Catalogs_ListDevices # ResourcePostActionFailed
      #   exampleFile: ..\examples\PostListDevicesByCatalog.json

# "ResourceCreationFailed: Internal Server Error"
  - scenario: Products
    description: Microsoft.AzureSphere/catalogs/{catalogName}/products/{productName}
    steps:
      - operationId: Products_CreateOrUpdate 
        # exampleFile: ..\examples\PutProduct.json
        parameters:
          resource:
            properties:
              description: Product Description
      - operationId: Products_ListByCatalog
        exampleFile: ..\examples\GetProducts.json
      - operationId: Products_Get
        exampleFile: ..\examples\GetProduct.json
      - operationId: Products_Update
        # exampleFile: ..\examples\PatchProduct.json
        parameters:
          properties:
            properties:
              description: Updated Product Description
      - operationId: Products_CountDevices
        exampleFile: ..\examples\PostCountDevicesProduct.json
      - operationId: Products_GenerateDefaultDeviceGroups
        exampleFile: ..\examples\PostGenerateDefaultDeviceGroups.json
      - operationId: Products_Delete
        exampleFile: ..\examples\DeleteProduct.json

  - scenario: DeviceGroups
    description: Microsoft.AzureSphere/catalogs/{catalogName}/products/{productName}/deviceGroups/{deviceGroupName}
    steps:
      - operationId: DeviceGroups_CreateOrUpdate
        exampleFile: ..\examples\PutDeviceGroup.json
      - operationId: DeviceGroups_ListByProduct
        exampleFile: ..\examples\GetDeviceGroups.json
      - operationId: DeviceGroups_Get
        exampleFile: ..\examples\GetDeviceGroup.json
      - operationId: DeviceGroups_Update
        exampleFile: ..\examples\PatchDeviceGroup.json
      - operationId: DeviceGroups_ClaimDevices
        exampleFile: ..\examples\PostClaimDevices.json
      - operationId: DeviceGroups_CountDevices
        exampleFile: ..\examples\PostCountDevicesDeviceGroup.json
      - operationId: DeviceGroups_Delete
        exampleFile: ..\examples\DeleteDeviceGroup.json

  - scenario: Devices
    description: Microsoft.AzureSphere/catalogs/{catalogName}/products/{productName}/deviceGroups/{deviceGroupName}/devices/{deviceName}
    steps:
      - operationId: Devices_CreateOrUpdate
        exampleFile: ..\examples\PutDevice.json
      - operationId: Devices_ListByDeviceGroup
        exampleFile: ..\examples\GetDevices.json
      - operationId: Devices_Get
        exampleFile: ..\examples\GetDevice.json
      - operationId: Devices_Update
        exampleFile: ..\examples\PatchDevice.json
      - operationId: Devices_GenerateCapabilityImage
        exampleFile: ..\examples\PostGenerateDeviceCapabilityImage.json
      - operationId: Devices_Delete
        exampleFile: ..\examples\DeleteDevice.json


  - scenario: Images
    description: Microsoft.AzureSphere/catalogs/{catalogName}/images/{imageName}
    steps:
      - operationId: Images_CreateOrUpdate
        exampleFile: ..\examples\PutImage.json
      - operationId: Images_ListByCatalog
        exampleFile: ..\examples\GetImages.json
      - operationId: Images_Get
        exampleFile: ..\examples\GetImage.json
      - operationId: Images_Delete
        exampleFile: ..\examples\DeleteImage.json

  - scenario: Deployments
    description: Microsoft.AzureSphere/catalogs/{catalogName}/products/{productName}/deviceGroups/{deviceGroupName}/deployments/{deploymentName}
    steps:
      - operationId: Deployments_CreateOrUpdate
        exampleFile: ..\examples\PutDeployment.json
      - operationId: Deployments_ListByDeviceGroup
        exampleFile: ..\examples\GetDeployments.json
      - operationId: Deployments_Get
        exampleFile: ..\examples\GetDeployment.json
      - operationId: Deployments_Delete
        exampleFile: ..\examples\DeleteDeployment.json
    
  - scenario: Operations
    description: Microsoft.AzureSphere/operations
    steps:
      - operationId: Operations_List
        exampleFile: ..\examples\GetOperations.json

  - scenario: Certificates
    description: Microsoft.AzureSphere/catalogs/{catalogName}/certificates
    steps:
      - operationId: Certificates_ListByCatalog
        exampleFile: ..\examples\GetCertificates.json
      - operationId: Certificates_Get
        exampleFile: ..\examples\GetCertificate.json
      - operationId: Certificates_RetrieveCertChain
        exampleFile: ..\examples\PostRetrieveCatalogCertChain.json
      - operationId: Certificates_RetrieveProofOfPossessionNonce
        exampleFile: ..\examples\PostRetrieveProofOfPossessionNonce.json

cleanUpSteps:
      - operationId: Catalogs_Delete
        exampleFile: ..\examples\DeleteCatalog.json
